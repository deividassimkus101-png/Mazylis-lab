<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Atvirkštinis koef. → EV + Kelly</title>
<style>
:root{
  --bg:#0e1116; --ink:#eaf2ff; --mut:#a8b3c8;
  --card:#121923; --edge:#12a3b; --acc:#00d3; --bad:#ff606b; --ok:#28d17c;
}
*{box-sizing:border-box}
body{margin:0;font:16px/1.5 system-ui,Segoe UI,Roboto,Ubuntu;background:var(--bg);color:var(--ink);padding:18px}
h1{margin:0 0 10px;text-align:center}
.lead{color:var(--mut);text-align:center;margin:0 0 18px}
.grid{max-width:860px;margin:0 auto;display:grid;gap:14px}
.card{background:var(--card);border:1px solid #233240;border-radius:14px;padding:16px;box-shadow:0 4px 8px rgba(0,0,0,.25)}
label{display:block;margin-top:8px;color:var(--mut)}
input,select{width:100%;padding:10px 12px;border-radius:10px;background:#0f141a;color:var(--ink);border:1px solid #2a3041}
input:focus,select:focus{outline:none;border-color:#2f8cff}
.btn{display:inline-block;margin-top:12px;padding:10px 14px;border-radius:10px;background:#00d3;color:#002b27;font-weight:700;border:0;cursor:pointer}
.badge{display:inline-block;padding:6px 10px;border-radius:10px;font-weight:700;margin:6px 6px 0 0}
.good{background:rgba(40,209,124,.18);color:var(--ok);border:1px solid var(--ok)}
.bad{background:rgba(255,96,107,.15);color:var(--bad);border:1px solid var(--bad)}
.note{color:var(--mut);font-size:.9rem}
strong{color:#e6f3ff}
</style>
</head>
<body>
  <h1>Atvirkštinis koeficientas → EV + Kelly</h1>
  <p class="lead">Įvesk <em>statymą</em> ir <em>išmoką</em> <u>arba</u> <em>pelną</em>. „Mažylis“ parodys VALUE ir Kelly statymo dydį.</p>

  <main class="grid">
    <section class="card">
      <label>Statymas (€)</label>
      <input id="stake" type="number" step="0.01" min="0" placeholder="pvz.: 30" />
      <label>Išmoka (€) – jei žinai</label>
      <input id="payout" type="number" step="0.01" min="0" placeholder="pvz.: 80" />
      <div class="note">arba</div>
      <label>Pelnas (€) – jei žinai</label>
      <input id="profit" type="number" step="0.01" placeholder="pvz.: 50" />
      <label>Tavo tikimybė p (%)</label>
      <input id="p" type="number" step="0.01" min="0" max="100" placeholder="pvz.: 35" />
      <label>Bankrolas (€)</label>
      <input id="bank" type="number" step="0.01" min="0" value="100" />
      <label>Kelly apimtis</label>
      <select id="kelly">
        <option value="1">100% Kelly</option>
        <option value="0.5" selected>50% Kelly</option>
        <option value="0.25">25% Kelly</option>
      </select>
      <button class="btn" id="calc">Apskaičiuoti</button>
    </section>

    <section class="card" id="out" style="display:none">
      <div id="flags"></div>
      <p><strong>o</strong> = <span id="odds">–</span> &nbsp;|&nbsp;
         <strong>Break-even p*</strong> = <span id="breakeven">–</span> &nbsp;|&nbsp;
         <strong>Edge</strong> = <span id="edge">–</span> &nbsp;|&nbsp;
         <strong>EV/€</strong> = <span id="ev">–</span></p>
      <p><strong>Kelly f*</strong> = <span id="kf">–</span> → pasirinkta <span id="kfrac">50%</span> → 
         <strong>Statymas ≈</strong> <span id="stakeKelly">0.00</span> €</p>
      <p class="note">„Dažniau laimės“ rodoma tik pagal p&gt;50% (vieno įvykio baigtis vis tiek atsitiktinė).</p>
    </section>
  </main>

<script>
const $ = id => document.getElementById(id);
const show = el => el.style.display = '';

function fmtPct(x){ return (x*100).toFixed(2) + '%'; }
function fmt(x){ return Number(x).toFixed(2); }

$('calc').onclick = () => {
  const S = parseFloat($('stake').value||'0');
  const R = parseFloat($('payout').value||'0');
  const P = parseFloat($('profit').value||'0');
  let p = parseFloat($('p').value||'0')/100;
  const bank = parseFloat($('bank').value||'0');
  const kFrac = parseFloat($('kelly').value);

  if(S<=0 || p<=0 || p>=1 || (!R && !P)){
    alert('Patikrink įvestis: statymas, išmoka ARBA pelnas, ir p (0–100%).');
    return;
  }

  // atvirkštinis koefas
  let o = R>0 ? (R/S) : (1 + P/S);
  const b = o - 1;

  // metrika
  const breakeven = 1/o;           // p*
  const edge = p - breakeven;      // p - 1/o
  const EVper€ = p*o - 1;          // per 1€ (decimal koef)

  // Kelly pilnas
  let kf = ((b*p) - (1-p)) / b;    // f*
  if(isNaN(kf)) kf = 0;
  if(kf < 0) kf = 0;

  const stakeKelly = bank * kf * kFrac;

  // UI
  $('odds').textContent = o.toFixed(4);
  $('breakeven').textContent = fmtPct(breakeven);
  $('edge').textContent = fmtPct(edge);
  $('ev').textContent = (EVper€>=0?'+':'') + EVper€ .toFixed(3);
  $('kf').textContent = (kf*100).toFixed(2) + '%';
  $('kfrac').textContent = (kFrac*100).toFixed(0) + '%';
  $('stakeKelly').textContent = fmt(stakeKelly);
  const flags = [];

  if(edge >= 0){
    flags.push('<span class="badge good">VALUE: TAIP</span>');
    flags.push('<span class="badge good">STATYTI</span>');
  }else{
    flags.push('<span class="badge bad">VALUE: NE</span>');
    flags.push('<span class="badge bad">NESTATYTI</span>');
  }
  if(p > 0.5) flags.push('<span class="badge good">Prognozė: dažniau LAIMĖS</span>');
  else        flags.push('<span class="badge bad">Prognozė: dažniau NELAIMĖS</span>');

  $('flags').innerHTML = flags.join(' ');
  show($('out'));
};
</script>
</body>
  </html>
